{
  "comments": [
    {
      "key": {
        "uuid": "08629d7a_d905bcea",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2020-08-14T21:01:15Z",
      "side": 1,
      "message": "LGTM",
      "revId": "d0571aa0197ab49e6317caa9056ed20c0a28a551",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fba57d24_0077707b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2020-08-16T13:06:16Z",
      "side": 1,
      "message": "LGTM but there\u0027s still places where we can have bytes not cleared when we try to lazy clear.",
      "revId": "d0571aa0197ab49e6317caa9056ed20c0a28a551",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7f565376_f4abd6e0",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 6
      },
      "lineNbr": 374,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2020-08-16T13:06:16Z",
      "side": 1,
      "message": "This check needs to take into account the aligned buffer size. Can we have a test that would have found this issue? Lazy zero init is quite critical for security, so we should test it the best we can.",
      "revId": "d0571aa0197ab49e6317caa9056ed20c0a28a551",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "321fe964_a5ff98a6",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 6
      },
      "lineNbr": 374,
      "author": {
        "id": 1000268
      },
      "writtenOn": "2020-08-17T21:47:51Z",
      "side": 1,
      "message": "Was this check meant to zero the data/content or memory (it says \"data\")? If it really meant the latter then the existing zero-init tests will fail if resource size aligned. Should I disable them for D3D12 + re-add to white-box?",
      "parentUuid": "7f565376_f4abd6e0",
      "revId": "d0571aa0197ab49e6317caa9056ed20c0a28a551",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d970f5e5_fdf9a403",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 6
      },
      "lineNbr": 392,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2020-08-16T13:06:16Z",
      "side": 1,
      "message": "ditto, including the testing part.",
      "revId": "d0571aa0197ab49e6317caa9056ed20c0a28a551",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aee56389_fac861f8",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 6
      },
      "lineNbr": 421,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2020-08-14T20:20:28Z",
      "side": 1,
      "message": "What is the cost of doing this? Should we cache the size or call Align(GetSize().. instead?",
      "range": {
        "startLine": 421,
        "startChar": 47,
        "endLine": 421,
        "endChar": 77
      },
      "revId": "d0571aa0197ab49e6317caa9056ed20c0a28a551",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a09256c2_7ecb8aa4",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 6
      },
      "lineNbr": 421,
      "author": {
        "id": 1000268
      },
      "writtenOn": "2020-08-14T20:45:50Z",
      "side": 1,
      "message": "Pretty cheap. GetDesc doesn\u0027t hot because it doesn\u0027t go down into the driver.",
      "parentUuid": "aee56389_fac861f8",
      "range": {
        "startLine": 421,
        "startChar": 47,
        "endLine": 421,
        "endChar": 77
      },
      "revId": "d0571aa0197ab49e6317caa9056ed20c0a28a551",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d3b482a4_8a0b268f",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 6
      },
      "lineNbr": 421,
      "author": {
        "id": 1000268
      },
      "writtenOn": "2020-08-14T20:45:50Z",
      "side": 1,
      "message": "Never seen GetDesc show up on profiles (we use it a lot elsewhere) but easy to cache if it does. Maybe a TODO?",
      "parentUuid": "aee56389_fac861f8",
      "range": {
        "startLine": 421,
        "startChar": 47,
        "endLine": 421,
        "endChar": 77
      },
      "revId": "d0571aa0197ab49e6317caa9056ed20c0a28a551",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b35df57c_0569b860",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 6
      },
      "lineNbr": 421,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2020-08-14T21:01:15Z",
      "side": 1,
      "message": "Good to know. Out of curiosity, is D3D storing the descriptor on the object then?",
      "parentUuid": "d3b482a4_8a0b268f",
      "range": {
        "startLine": 421,
        "startChar": 47,
        "endLine": 421,
        "endChar": 77
      },
      "revId": "d0571aa0197ab49e6317caa9056ed20c0a28a551",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "500eddc7_c3130322",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 6
      },
      "lineNbr": 421,
      "author": {
        "id": 1000268
      },
      "writtenOn": "2020-08-14T22:33:22Z",
      "side": 1,
      "message": "Yea, I would guess so. It doesn\u0027t go down into the driver like RESOURCE_ALLOCATION_INFO so it would surprise me if it was hot.\n\nSpeaking of which, reminds me to figure out how to avoid calling RESOURCE_ALLOCATION_INFO twice for sub-allocation.",
      "parentUuid": "b35df57c_0569b860",
      "range": {
        "startLine": 421,
        "startChar": 47,
        "endLine": 421,
        "endChar": 77
      },
      "revId": "d0571aa0197ab49e6317caa9056ed20c0a28a551",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "777c458d_7fbe299e",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 6
      },
      "lineNbr": 421,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2020-08-14T22:36:12Z",
      "side": 1,
      "message": "^ I may have just partially done that in https://dawn-review.googlesource.com/c/dawn/+/26840 . I\u0027m not sure we can actually remove calling it twice completely though. Unless we do the computation for estimating the size of the texture and required alignment ourselves somehow.",
      "parentUuid": "500eddc7_c3130322",
      "range": {
        "startLine": 421,
        "startChar": 47,
        "endLine": 421,
        "endChar": 77
      },
      "revId": "d0571aa0197ab49e6317caa9056ed20c0a28a551",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3044fa36_8cfd4d43",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 6
      },
      "lineNbr": 421,
      "author": {
        "id": 1000268
      },
      "writtenOn": "2020-08-14T23:16:10Z",
      "side": 1,
      "message": "Oh, thanks for adding me.\n\n\u003e Unless we do the computation for estimating the size of the texture and required alignment ourselves somehow.\n\nI think the algo goes like this: if we know the texture can be 4K aligned then always use small placement w/o calling GetResourceAllocationInfo() twice. To be 4K aligned, we need 64K / 4K \u003d 16 tiles. To count the number of tiles, divide the texture size by the tile size. For example, the tile size for RGBA8 for 4 bytes * 8 \u003d 32 bit (w\u003d32 texels, h\u003d32 texels).",
      "parentUuid": "777c458d_7fbe299e",
      "range": {
        "startLine": 421,
        "startChar": 47,
        "endLine": 421,
        "endChar": 77
      },
      "revId": "d0571aa0197ab49e6317caa9056ed20c0a28a551",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": false
    }
  ]
}