{
  "comments": [
    {
      "key": {
        "uuid": "d1a4f46c_2261f011",
        "filename": "src/dawn_native/metal/RenderPipelineMTL.mm",
        "patchSetId": 6
      },
      "lineNbr": 285,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2019-06-28T10:23:43Z",
      "side": 1,
      "message": "I\u0027m pretty sure this was correct see explanation in [1]",
      "revId": "2d4e5b854942958b6acee000a0fc532c6e7ebc6f",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d8a7bd83_2151a37e",
        "filename": "src/dawn_native/metal/RenderPipelineMTL.mm",
        "patchSetId": 6
      },
      "lineNbr": 285,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2019-06-28T16:44:35Z",
      "side": 1,
      "message": "I thought you added a test for this behavior, but I guess not.",
      "parentUuid": "d1a4f46c_2261f011",
      "revId": "2d4e5b854942958b6acee000a0fc532c6e7ebc6f",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "342ccbe4_7dabe8d9",
        "filename": "src/dawn_native/metal/RenderPipelineMTL.mm",
        "patchSetId": 6
      },
      "lineNbr": 285,
      "author": {
        "id": 1000017
      },
      "writtenOn": "2019-06-28T17:44:38Z",
      "side": 1,
      "message": "Sorry, Corentin and Austin, I didn\u0027t understand you. What do you mean? Did you mean that the original code here was correct, and I shouldn\u0027t change the code snippet here? \n\nBut the test fail (see patchset 3, and the bots failure was: https://ci.chromium.org/p/chromium/builders/try/mac-dawn-rel/1428). So, the root cause is that either the new added culling tests were incorrect, or the original code snippet here was incorrect. I think the reason was the latter, not the new added tests. \n\nPer my understanding, if we say that Y axis is down in WebGPU (Corentin told me about this in https://dawn-review.googlesource.com/c/dawn/+/8401), and Y is actually down on some backend (like Metal backend and Vulkan backend), then we don\u0027t need to invert winding. Otherwise (like OpenGL backend) we have to invert winding.  \n\nOne example here: if we draw a triangle with 3 points in this sequence: A(-1, -1), B(-1, 0), C(0, -1). The triangle is CW if Y is up, and it is CCW if Y is down. So if we say Y axis is down is WebGPU, then web developers will think that triangle ABC is CCW. As a result, when we map it to Metal, we don\u0027t need to invert CCW to CW. On the contrary, when we implement it on OpenGL, we need to invert CCW to CW.    \n\nWhat do you think?\n\n(btw, I didn\u0027t invert CCW/CW to CW/CCW on Vulkan backend and the new added culling tests can pass on my local machine.)",
      "parentUuid": "d8a7bd83_2151a37e",
      "revId": "2d4e5b854942958b6acee000a0fc532c6e7ebc6f",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2d55336e_a6dcf056",
        "filename": "src/dawn_native/metal/RenderPipelineMTL.mm",
        "patchSetId": 6
      },
      "lineNbr": 285,
      "author": {
        "id": 1000015
      },
      "writtenOn": "2019-06-28T17:54:38Z",
      "side": 1,
      "message": "I was looking at this at the same time, and I\u0027m confused as well: If these tests all pass on all backends, then they must be behaving consistently. And yet, this switch was needed for actual demos to render correctly.\n\nDoes shader (-1,-1) show up in the lower left or the upper left? This test seems to say it\u0027s the upper left, but I thought it was the lower left. I\u0027m trying to test this now.",
      "parentUuid": "342ccbe4_7dabe8d9",
      "revId": "2d4e5b854942958b6acee000a0fc532c6e7ebc6f",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "11b16cff_88f905d3",
        "filename": "src/dawn_native/metal/RenderPipelineMTL.mm",
        "patchSetId": 6
      },
      "lineNbr": 285,
      "author": {
        "id": 1000015
      },
      "writtenOn": "2019-06-28T18:05:00Z",
      "side": 1,
      "message": "Ok. (-1, -1) is the upper left. This is consistent across the backends.\n\nI forgot we don\u0027t have culling on the other backends yet. How does this test pass on those backends?",
      "parentUuid": "2d55336e_a6dcf056",
      "revId": "2d4e5b854942958b6acee000a0fc532c6e7ebc6f",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9f1d2c54_96e1a3bb",
        "filename": "src/dawn_native/metal/RenderPipelineMTL.mm",
        "patchSetId": 6
      },
      "lineNbr": 285,
      "author": {
        "id": 1000017
      },
      "writtenOn": "2019-06-28T18:10:49Z",
      "side": 1,
      "message": "Hey Kai, thanks for your testing. (-1, -1) is upper left, seems that we can say that Y axis is down. Did you test it on OpenGL? Is (-1, -1) upper left on OpenGL backend? \n\nI implemented culling on Vulkan backend at https://dawn-review.googlesource.com/c/dawn/+/8300. It was blocked because of no tests.",
      "parentUuid": "11b16cff_88f905d3",
      "revId": "2d4e5b854942958b6acee000a0fc532c6e7ebc6f",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "59b4f0c6_bbc252b5",
        "filename": "src/dawn_native/metal/RenderPipelineMTL.mm",
        "patchSetId": 6
      },
      "lineNbr": 285,
      "author": {
        "id": 1000017
      },
      "writtenOn": "2019-06-28T18:14:34Z",
      "side": 1,
      "message": "BTW, did you test (-1, -1) via dawn with different backends, or you tested it on native backends directly? For dawn, I suspected that we might flip Y, so it is consistent across different backends and Y axis is up on all backends. But for native OpenGL backend, I am afraid Y is down.",
      "parentUuid": "9f1d2c54_96e1a3bb",
      "revId": "2d4e5b854942958b6acee000a0fc532c6e7ebc6f",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0af19bf6_1d3310a0",
        "filename": "src/dawn_native/metal/RenderPipelineMTL.mm",
        "patchSetId": 6
      },
      "lineNbr": 285,
      "author": {
        "id": 1000017
      },
      "writtenOn": "2019-06-28T18:16:46Z",
      "side": 1,
      "message": "(Whoops, sent it too fast and made a mistake) BTW, did you test (-1, -1) via dawn with different backends, or you tested it on native backends directly? For dawn, I suspected that we might flip Y, so it is consistent across different backends and Y axis is DOWN on all backends. But for native OpenGL backend, I am afraid Y is UP.",
      "parentUuid": "59b4f0c6_bbc252b5",
      "revId": "2d4e5b854942958b6acee000a0fc532c6e7ebc6f",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "74cc03fb_c7a94ba4",
        "filename": "src/tests/end2end/CullingTests.cpp",
        "patchSetId": 6
      },
      "lineNbr": 26,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2019-06-28T10:23:43Z",
      "side": 1,
      "message": "[1] These triangles are actually the inverse of what\u0027s described in the comment. The winding of a triangle is done in \"framebuffer coordinate\" (Vulkan 1.1 spec 24.7.1. Basic Polygon Rasterization) (GLES 3.1 spec 13.5.1 Basic Polygon Rasterization) using the regular mathematical convention of Y being \"up\". That the displaying of textures on the screen is Y down is independent of frontFace computations.",
      "revId": "2d4e5b854942958b6acee000a0fc532c6e7ebc6f",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "05f1a44c_de352b6f",
        "filename": "src/tests/end2end/CullingTests.cpp",
        "patchSetId": 6
      },
      "lineNbr": 91,
      "author": {
        "id": 1000015
      },
      "writtenOn": "2019-06-28T17:54:38Z",
      "side": 1,
      "message": "nit: factor out these constants into \"kTriangleVisible\" and \"kTriangleCulled\"",
      "range": {
        "startLine": 91,
        "startChar": 34,
        "endLine": 91,
        "endChar": 55
      },
      "revId": "2d4e5b854942958b6acee000a0fc532c6e7ebc6f",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dcc9d8e4_52e58f28",
        "filename": "src/tests/end2end/CullingTests.cpp",
        "patchSetId": 6
      },
      "lineNbr": 91,
      "author": {
        "id": 1000015
      },
      "writtenOn": "2019-06-28T18:05:00Z",
      "side": 1,
      "message": "And then you can have kCCWTriangleColor \u003d isCCWTriangleCulled ? ... : ...",
      "parentUuid": "05f1a44c_de352b6f",
      "range": {
        "startLine": 91,
        "startChar": 34,
        "endLine": 91,
        "endChar": 55
      },
      "revId": "2d4e5b854942958b6acee000a0fc532c6e7ebc6f",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    }
  ]
}