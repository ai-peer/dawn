{
  "comments": [
    {
      "key": {
        "uuid": "30a6eda6_a85f7789",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 4
      },
      "lineNbr": 134,
      "author": {
        "id": 1000015
      },
      "writtenOn": "2019-06-11T17:05:36Z",
      "side": 1,
      "message": "same as below",
      "range": {
        "startLine": 134,
        "startChar": 58,
        "endLine": 134,
        "endChar": 59
      },
      "revId": "0770d95e165b2df86befc0e03f59c736b93fcd75",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3df12ec4_d2122166",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 4
      },
      "lineNbr": 134,
      "author": {
        "id": 1000248
      },
      "writtenOn": "2019-06-11T18:52:47Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "30a6eda6_a85f7789",
      "range": {
        "startLine": 134,
        "startChar": 58,
        "endLine": 134,
        "endChar": 59
      },
      "revId": "0770d95e165b2df86befc0e03f59c736b93fcd75",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "decb4525_7f3b451d",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 4
      },
      "lineNbr": 136,
      "author": {
        "id": 1000015
      },
      "writtenOn": "2019-06-11T17:05:36Z",
      "side": 1,
      "message": "My reading of the linked documentation is that even though an explicit transition isn\u0027t needed, a transition still occurs, leaving the resource no longer in the COMMON state.\n\nIf that\u0027s the case, then calls to SetUsage in CommandBufferD3D12.cpp need to be moved outside of the if (CreateD3D12ResourceBarrierIfNeeded()) block.",
      "revId": "0770d95e165b2df86befc0e03f59c736b93fcd75",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7ad08c3b_98e6dc5a",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 4
      },
      "lineNbr": 136,
      "author": {
        "id": 1000015
      },
      "writtenOn": "2019-06-11T17:07:40Z",
      "side": 1,
      "message": "(Sorry if I\u0027m wrong about that, didn\u0027t read the docs in great detail. But my reading was that this is true except when implicit state decay occurs.)",
      "parentUuid": "decb4525_7f3b451d",
      "revId": "0770d95e165b2df86befc0e03f59c736b93fcd75",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2c75a57c_463eafab",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 4
      },
      "lineNbr": 136,
      "author": {
        "id": 1000248
      },
      "writtenOn": "2019-06-11T17:40:08Z",
      "side": 1,
      "message": "Ah, good catch. Your understanding is correct. Careless mistake on my end.",
      "parentUuid": "7ad08c3b_98e6dc5a",
      "revId": "0770d95e165b2df86befc0e03f59c736b93fcd75",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "88961f97_b0c5499a",
        "filename": "src/dawn_native/d3d12/BufferD3D12.cpp",
        "patchSetId": 4
      },
      "lineNbr": 136,
      "author": {
        "id": 1000248
      },
      "writtenOn": "2019-06-11T18:52:47Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2c75a57c_463eafab",
      "revId": "0770d95e165b2df86befc0e03f59c736b93fcd75",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "42144989_b4ac1535",
        "filename": "src/dawn_native/d3d12/TextureD3D12.cpp",
        "patchSetId": 4
      },
      "lineNbr": 192,
      "author": {
        "id": 1000015
      },
      "writtenOn": "2019-06-11T17:05:36Z",
      "side": 1,
      "message": "nit: xor is technically correct here, but I think it\u0027s equivalent and clearer to use ||. That also allows you to rewrite more clearly, something like:\n\n  if (mLastState \u003d\u003d D3D12_RESOURCE_STATE_COMMON) {\n    if (newState \u003d\u003d D3D12_RESOURCE_STATE_COPY_DEST) {\n      return false;\n    }\n    if (newState \u003d\u003d (newState \u0026 kD3D12TextureReadOnlyStates)) {\n      return false;\n    }\n  }",
      "range": {
        "startLine": 192,
        "startChar": 58,
        "endLine": 192,
        "endChar": 59
      },
      "revId": "0770d95e165b2df86befc0e03f59c736b93fcd75",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d97eb70d_72a6857f",
        "filename": "src/dawn_native/d3d12/TextureD3D12.cpp",
        "patchSetId": 4
      },
      "lineNbr": 192,
      "author": {
        "id": 1000248
      },
      "writtenOn": "2019-06-11T17:40:08Z",
      "side": 1,
      "message": "I would prefer to keep the xor. Outside of the Dawn/WebGPU context, a D3D12 implicit transition is only possible when transitioning to 1) one or more read states, xor 2) one write usage. Although I can\u0027t think of the scenario where this 1 read/1 write transition would occur in Dawn - I think that not making this explicit could cause confusion or a bug in the future.",
      "parentUuid": "42144989_b4ac1535",
      "range": {
        "startLine": 192,
        "startChar": 58,
        "endLine": 192,
        "endChar": 59
      },
      "revId": "0770d95e165b2df86befc0e03f59c736b93fcd75",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9287eda3_e0136172",
        "filename": "src/dawn_native/d3d12/TextureD3D12.cpp",
        "patchSetId": 4
      },
      "lineNbr": 192,
      "author": {
        "id": 1000015
      },
      "writtenOn": "2019-06-11T17:50:23Z",
      "side": 1,
      "message": "OK, sounds good. I\u0027d still like to layer the logic just to make it easier to read. Something along these lines:\n\n  if (mLastState \u003d\u003d D3D12_RESOURCE_STATE_COMMON) {\n    bool singleWrite \u003d newState \u003d\u003d D3D12_RESOURCE_STATE_COPY_DEST;\n    bool multipleRead \u003d newState \u003d\u003d (newState \u0026 kD3D12TextureReadOnlyStates);\n    if (singleWrite ^ multipleRead) {\n      return false;\n    }\n  }\n\nWDYT?",
      "parentUuid": "d97eb70d_72a6857f",
      "range": {
        "startLine": 192,
        "startChar": 58,
        "endLine": 192,
        "endChar": 59
      },
      "revId": "0770d95e165b2df86befc0e03f59c736b93fcd75",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d19723c9_1b758e10",
        "filename": "src/dawn_native/d3d12/TextureD3D12.cpp",
        "patchSetId": 4
      },
      "lineNbr": 192,
      "author": {
        "id": 1000248
      },
      "writtenOn": "2019-06-11T17:52:13Z",
      "side": 1,
      "message": "Sounds good.",
      "parentUuid": "9287eda3_e0136172",
      "range": {
        "startLine": 192,
        "startChar": 58,
        "endLine": 192,
        "endChar": 59
      },
      "revId": "0770d95e165b2df86befc0e03f59c736b93fcd75",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8e46328f_65a6f964",
        "filename": "src/dawn_native/d3d12/TextureD3D12.cpp",
        "patchSetId": 4
      },
      "lineNbr": 192,
      "author": {
        "id": 1000248
      },
      "writtenOn": "2019-06-11T18:52:47Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d19723c9_1b758e10",
      "range": {
        "startLine": 192,
        "startChar": 58,
        "endLine": 192,
        "endChar": 59
      },
      "revId": "0770d95e165b2df86befc0e03f59c736b93fcd75",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd",
      "unresolved": false
    }
  ]
}