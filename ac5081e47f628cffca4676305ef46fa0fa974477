{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "5ee269a3_5c39c36f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 63
      },
      "lineNbr": 0,
      "author": {
        "id": 1002831
      },
      "writtenOn": "2023-09-08T21:12:53Z",
      "side": 1,
      "message": "Overall LGTM! I think most of Corentin\u0027s comment have also been addressed so I closed them to remove the clutter!\n\nFinal note: I wanted to make sure that the `Instance` clears out the `EventManager` given the ref-cycle. Maybe I missed it, but I didn\u0027t see that handling?",
      "revId": "ac5081e47f628cffca4676305ef46fa0fa974477",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3ea0b030_644b1fd3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 63
      },
      "lineNbr": 0,
      "author": {
        "id": 1000015
      },
      "writtenOn": "2023-09-08T21:21:47Z",
      "side": 1,
      "message": "Oops a few replies I forgot to send",
      "revId": "ac5081e47f628cffca4676305ef46fa0fa974477",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b5af6e48_ea2c2e4f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 63
      },
      "lineNbr": 0,
      "author": {
        "id": 1000015
      },
      "writtenOn": "2023-09-08T21:27:53Z",
      "side": 1,
      "message": "I decided to just do it in the destructor (which will be automatically called by Instance\u0027s destructor. Unlike devices, client instances, etc., I don\u0027t think dawn::native::InstanceBase needs an explicit shutdown prior to the destructor.",
      "parentUuid": "5ee269a3_5c39c36f",
      "revId": "ac5081e47f628cffca4676305ef46fa0fa974477",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "99f0aa05_fc95b61f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 63
      },
      "lineNbr": 0,
      "author": {
        "id": 1000015
      },
      "writtenOn": "2023-09-08T21:33:41Z",
      "side": 1,
      "message": "Never mind, I didn\u0027t think this through. Can\u0027t break cycles in the destructor because cycles prevent the destructor from running.\n\nI realized there\u0027s WillDropLastExternalRef where we do other ref cycle breaking and that\u0027s where it should be.",
      "parentUuid": "b5af6e48_ea2c2e4f",
      "revId": "ac5081e47f628cffca4676305ef46fa0fa974477",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "82618f18_4d403809",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 63
      },
      "lineNbr": 0,
      "author": {
        "id": 1000015
      },
      "writtenOn": "2023-09-08T21:51:35Z",
      "side": 1,
      "message": "And Loko points out that doesn\u0027t work either because the user could drop the instance if they\u0027re not using WaitAny/ProcessEvents.\nThis would mean we have to make sure any Spontaneous events in the EventManager.\nAnd any Spontaneous|Future or Spontaneous|ProcessEvents events would have to be dropped without completing and assumed to complete spontaneously later.\n\nToo complicated to get right. Just gonna use a WeakRef and break the cycle properly.",
      "parentUuid": "99f0aa05_fc95b61f",
      "revId": "ac5081e47f628cffca4676305ef46fa0fa974477",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b79304e3_23af6be3",
        "filename": "src/dawn/native/EventManager.h",
        "patchSetId": 63
      },
      "lineNbr": 109,
      "author": {
        "id": 1002831
      },
      "writtenOn": "2023-09-08T21:12:53Z",
      "side": 1,
      "message": "Just a note for this (for myself or anyone that goes to change this later), I think this can eventually be a `WeakRef` to break the cycle. If the device is gone, I assume that the callback can just be fired either as a `Shutdown` case or as a success to make it look like the device isn\u0027t gone. Probably just depends on what we decide for the contract.",
      "range": {
        "startLine": 106,
        "startChar": 4,
        "endLine": 109,
        "endChar": 28
      },
      "revId": "ac5081e47f628cffca4676305ef46fa0fa974477",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    }
  ]
}