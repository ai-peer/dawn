{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "045a7dc9_83d83da9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1000685
      },
      "writtenOn": "2023-02-15T01:12:13Z",
      "side": 1,
      "message": "Send for review, but maybe not to land if we don\u0027t want to keep two versions as we plan to add this to tint perfmon bots.\n\nLocal result (build with highest optimization flags):\n```\nis_official_build \u003d true  # Enables highest optimization level, using LTO on some platforms\nuse_dawn \u003d true           # Required to build Dawn\nuse_cfi_icall\u003dfalse       # Required because Dawn dynamically loads function pointers, and we don\u0027t sanitize them yet.\nuse_goma \u003d true\nis_debug \u003d false\n```\n\nWithout binding validation:\n\n```\nTest name: BindingsValidationPerf.Run/Null_Null_backend_BusyValidation\nrunning with 6496 steps.\nwall_time: 3085.05\nwall_time: 3193.79, mean: 3139.42, variation: 1.73%\nwall_time: 3113.25, mean: 3130.70, variation: 1.47%\nwall_time: 3132.23, mean: 3131.08, variation: 1.27%\nwall_time: 3099.49, mean: 3124.76, variation: 1.21%\nwall_time: 3069.77, mean: 3115.60, variation: 1.29%\nwall_time: 3120.85, mean: 3116.35, variation: 1.20%\nwall_time: 3028.16, mean: 3105.32, variation: 1.46%, truncated mean: 3103.44, variation: 0.69%\nwall_time: 3053.27, mean: 3099.54, variation: 1.48%, truncated mean: 3096.27, variation: 0.85%\nwall_time: 3023.47, mean: 3091.93, variation: 1.59%, truncated mean: 3087.76, variation: 1.08%\nwall_time: 3117.46, mean: 3094.25, variation: 1.53%, truncated mean: 3091.06, variation: 1.06%\nwall_time: 3057.08, mean: 3091.16, variation: 1.51%, truncated mean: 3087.66, variation: 1.06%\nwall_time: 3071.12, mean: 3089.61, variation: 1.46%, truncated mean: 3086.16, variation: 1.02%\nwall_time: 3155.76, mean: 3094.34, variation: 1.51%, truncated mean: 3091.96, variation: 1.16%\nwall_time: 3064.20, mean: 3092.33, variation: 1.48%, truncated mean: 3089.82, variation: 1.14%\nwall_time: 2968.37, mean: 3084.58, variation: 1.73%, truncated mean: 3084.33, variation: 1.00%\nwall_time: 3016.59, mean: 3080.58, variation: 1.76%, truncated mean: 3079.65, variation: 1.10%\nwall_time: 3030.28, mean: 3077.79, variation: 1.75%, truncated mean: 3076.12, variation: 1.14%\nwall_time: 2961.76, mean: 3071.68, variation: 1.91%, truncated mean: 3072.15, variation: 1.20%\nwall_time: 2939.68, mean: 3065.08, variation: 2.09%, truncated mean: 3065.66, variation: 1.42%\nwall_time: 2990.36, mean: 3061.52, variation: 2.10%, truncated mean: 3061.23, variation: 1.50%\nwall_time: 2999.02, mean: 3058.68, variation: 2.10%, truncated mean: 3057.78, variation: 1.53%\nwall_time: 2945.95, mean: 3053.78, variation: 2.19%, truncated mean: 3052.72, variation: 1.65%\nwall_time: 3003.16, mean: 3051.67, variation: 2.17%, truncated mean: 3050.61, variation: 1.47%\nwall_time: 3080.64, mean: 3052.83, variation: 2.13%, truncated mean: 3052.19, variation: 1.44%\nwall_time: 3125.69, mean: 3055.63, variation: 2.14%, truncated mean: 3055.86, variation: 1.50%\nwall_time: 3007.94, mean: 3053.87, variation: 2.12%, truncated mean: 3053.58, variation: 1.50%\nwall_time: 3119.49, mean: 3056.21, variation: 2.12%, truncated mean: 3056.58, variation: 1.53%\nwall_time: 3088.54, mean: 3057.32, variation: 2.09%, truncated mean: 3057.97, variation: 1.51%\nwall_time: 3152.79, mean: 3060.51, variation: 2.13%, truncated mean: 3061.06, variation: 1.56%\n```\n\n\nWith binding validation:\n\n```\nTest name: BindingsValidationPerf.Run/Null_Null_backend_BusyValidation\nrunning with 6503 steps.\nwall_time: 3164.29\nwall_time: 3189.41, mean: 3176.85, variation: 0.40%\nwall_time: 3166.53, mean: 3173.41, variation: 0.36%\nwall_time: 3240.29, mean: 3190.13, variation: 0.96%\nwall_time: 3157.22, mean: 3183.55, variation: 0.95%\nwall_time: 3171.11, mean: 3181.47, variation: 0.88%\nwall_time: 3126.36, mean: 3173.60, variation: 1.02%\nwall_time: 3194.69, mean: 3176.24, variation: 0.98%, truncated mean: 3173.88, variation: 0.43%\nwall_time: 3143.56, mean: 3172.61, variation: 0.98%, truncated mean: 3169.55, variation: 0.52%\nwall_time: 3216.13, mean: 3176.96, variation: 1.01%, truncated mean: 3175.37, variation: 0.69%\nwall_time: 3100.87, mean: 3170.04, variation: 1.19%, truncated mean: 3169.92, variation: 0.81%\nwall_time: 3102.37, mean: 3164.40, variation: 1.29%, truncated mean: 3163.17, variation: 1.00%\nwall_time: 3167.75, mean: 3164.66, variation: 1.23%, truncated mean: 3163.58, variation: 0.96%\nwall_time: 3131.86, mean: 3162.32, variation: 1.22%, truncated mean: 3160.94, variation: 0.96%\nwall_time: 3138.22, mean: 3160.71, variation: 1.19%, truncated mean: 3159.19, variation: 0.94%\nwall_time: 3200.17, mean: 3163.18, variation: 1.19%, truncated mean: 3162.60, variation: 0.74%\nwall_time: 3138.58, mean: 3161.73, variation: 1.17%, truncated mean: 3160.75, variation: 0.74%\nwall_time: 2893.41, mean: 3146.82, variation: 2.26%, truncated mean: 3156.58, variation: 0.86%\nwall_time: 3190.99, mean: 3149.15, variation: 2.22%, truncated mean: 3158.87, variation: 0.87%\nwall_time: 3184.03, mean: 3150.89, variation: 2.18%, truncated mean: 3160.45, variation: 0.86%\nwall_time: 3164.13, mean: 3151.52, variation: 2.13%, truncated mean: 3160.66, variation: 0.84%\nwall_time: 3173.70, mean: 3152.53, variation: 2.09%, truncated mean: 3161.39, variation: 0.82%\nwall_time: 3298.79, mean: 3158.89, variation: 2.24%, truncated mean: 3164.27, variation: 0.89%\nwall_time: 3002.47, mean: 3152.37, variation: 2.41%, truncated mean: 3161.39, variation: 0.82%\nwall_time: 3245.03, mean: 3156.08, variation: 2.43%, truncated mean: 3164.27, variation: 0.89%\nwall_time: 3165.65, mean: 3156.45, variation: 2.38%, truncated mean: 3164.34, variation: 0.86%\nwall_time: 3199.92, mean: 3158.06, variation: 2.35%, truncated mean: 3166.03, variation: 0.88%\nwall_time: 3215.87, mean: 3160.12, variation: 2.33%, truncated mean: 3168.30, variation: 0.92%\nwall_time: 2947.82, mean: 3152.80, variation: 2.61%, truncated mean: 3165.37, variation: 1.00%\nwall_time: 3067.97, mean: 3149.97, variation: 2.61%, truncated mean: 3161.31, variation: 1.15%\n```\n\n\nNot very sure about how to interpret all the interations. But looks like there\u0027s an increase of mean wall_time from 30xx to 31xx.\n\n\n(Haven\u0027t tried your other code optimization suggestion, will try it tomorrow)",
      "revId": "223be4ea70a235ed559eb3bf7851c6a4f514ee62",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "120c0f05_1e683477",
        "filename": "src/dawn/tests/perf_tests/BindingsValidationPerf.cpp",
        "patchSetId": 6
      },
      "lineNbr": 258,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2023-02-15T17:44:07Z",
      "side": 1,
      "message": "why std::min? these should always be the defaults unless we have the test harness request higher ones",
      "range": {
        "startLine": 258,
        "startChar": 46,
        "endLine": 258,
        "endChar": 54
      },
      "revId": "223be4ea70a235ed559eb3bf7851c6a4f514ee62",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "00b605d1_da7bd673",
        "filename": "src/dawn/tests/perf_tests/BindingsValidationPerf.cpp",
        "patchSetId": 6
      },
      "lineNbr": 337,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2023-02-15T17:44:07Z",
      "side": 1,
      "message": "typo: bindings",
      "range": {
        "startLine": 337,
        "startChar": 29,
        "endLine": 337,
        "endChar": 37
      },
      "revId": "223be4ea70a235ed559eb3bf7851c6a4f514ee62",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2f5713c5_28598e5e",
        "filename": "src/dawn/tests/perf_tests/BindingsValidationPerf.cpp",
        "patchSetId": 6
      },
      "lineNbr": 375,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2023-02-15T17:44:07Z",
      "side": 1,
      "message": "I think we should have an inner loop here that runs the (SetBindGroup, DispatchWorkgroups) 1000 times. That way most of the cost is all from validation that runs on dispatch.\n\nAlso, do we need to set the pipeline and both bind groups every time? It would be better to do the most minimal and cheapest change - to make the validation run again.\nSo, would it possible to make the pipeline layouts mostly identical except for a small difference? I think that would simplify a bunch of the initialization code in SetUp",
      "revId": "223be4ea70a235ed559eb3bf7851c6a4f514ee62",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4c43777a_7e424f88",
        "filename": "src/dawn/tests/perf_tests/BindingsValidationPerf.cpp",
        "patchSetId": 6
      },
      "lineNbr": 398,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2023-02-15T17:44:07Z",
      "side": 1,
      "message": "shouldn\u0027t need a new pass - can use the same one",
      "range": {
        "startLine": 398,
        "startChar": 8,
        "endLine": 398,
        "endChar": 88
      },
      "revId": "223be4ea70a235ed559eb3bf7851c6a4f514ee62",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c1213b94_f9b6f34b",
        "filename": "src/dawn/tests/perf_tests/BindingsValidationPerf.cpp",
        "patchSetId": 6
      },
      "lineNbr": 406,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2023-02-15T17:44:07Z",
      "side": 1,
      "message": "would we precompute this so it\u0027s cheaper to set here?",
      "range": {
        "startLine": 402,
        "startChar": 12,
        "endLine": 406,
        "endChar": 13
      },
      "revId": "223be4ea70a235ed559eb3bf7851c6a4f514ee62",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    }
  ]
}