{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "a1538aae_ec3a6007",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1000019
      },
      "writtenOn": "2023-05-29T09:08:22Z",
      "side": 1,
      "message": "Hi all,\n\nThis change has caused regressions in our workload as it prevents us from creating the buffers larger than 1\u003c\u003c27, while our workloads work well on Win11 x64 on both Nvidia and Intel GPUs with previous versions of Chromium (e.g. chrome stable 113). Can we only apply this restriction on ARM devices?",
      "revId": "e9ee094d28f5cb6623c68467c0ffbf2ce33481b6",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "647e1b51_e2e7f4de",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1002536
      },
      "writtenOn": "2023-05-29T09:13:58Z",
      "side": 1,
      "message": "Our workloads require using some large storage buffer, but with this CL all D3D adapters can only support 128MB storage buffer binding size now (previously we can go to 2GB-4), and that cause regression.\nBy the way, the D3D spec say this limitation `D3D11_REQ_BUFFER_RESOURCE_TEXEL_COUNT_2_TO_EXP` is \"Number of texels (independent of struct size) in a buffer\". I am not sure how to understand this description, does a texel only take 1 byte? (Because the limit `maxStorageBufferBindingSize` here is in bytes)",
      "parentUuid": "a1538aae_ec3a6007",
      "revId": "e9ee094d28f5cb6623c68467c0ffbf2ce33481b6",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4227d40f_a7603112",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1002536
      },
      "writtenOn": "2023-05-30T05:30:27Z",
      "side": 1,
      "message": "I found the following note in D3D11 spec [1],\n\u003e [D3D11] Noted that the Buffer element limit of 2²⁷ texels continues to apply to the view of Structured Buffers (new in D3D11), but not to Raw Buffer Views (also new in D3D11). In the latter case, addressing is at 32-bit granularity and the entire contents of the Raw Buffer view is available, at most 2048 MB as mentioned above.\n\nWould this help? I thought we use raw buffer view in Dawn.\n\n[1]: https://microsoft.github.io/DirectX-Specs/d3d/archive/D3D11_3_FunctionalSpec.htm#UAVs:~:text\u003d%5BD3D11%5D%20Noted%20that,as%20mentioned%20above.",
      "parentUuid": "647e1b51_e2e7f4de",
      "revId": "e9ee094d28f5cb6623c68467c0ffbf2ce33481b6",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2e28d8f5_d70dd206",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1003636
      },
      "writtenOn": "2023-05-30T05:52:34Z",
      "side": 1,
      "message": "Hello, Jiawei and Zhaoming, thanks for let me know that.\nI\u0027ll rework this patch to apply the limit to ARM devices or the limit test, today. Sorry for the trouble. We need move the change from the D3D backend to the test.",
      "parentUuid": "4227d40f_a7603112",
      "revId": "e9ee094d28f5cb6623c68467c0ffbf2ce33481b6",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "97ee2b5f_90416d1a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1002536
      },
      "writtenOn": "2023-05-30T06:06:48Z",
      "side": 1,
      "message": "Thanks for your help!",
      "parentUuid": "2e28d8f5_d70dd206",
      "revId": "e9ee094d28f5cb6623c68467c0ffbf2ce33481b6",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ac013995_1991d557",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2023-05-30T15:51:31Z",
      "side": 1,
      "message": "sorry for my misunderstanding here. So this is not a real limit then but a bug in the ARM driver?\n\nIs there something else we can query to determine the actual maxStorageBufferBindingSize?",
      "parentUuid": "97ee2b5f_90416d1a",
      "revId": "e9ee094d28f5cb6623c68467c0ffbf2ce33481b6",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "13bc1682_3f30dbe1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1003636
      },
      "writtenOn": "2023-05-30T20:53:22Z",
      "side": 1,
      "message": "What I was told is, that this limit depends on the type of buffer. It doesn\u0027t apply to raw buffer. It only applies to typed buffer, or structured buffer. So, we are using a raw buffer here, yes it would be driver bug. In any case, I think we need move it to the test. I\u0027m not sure if we can query and determine the actual size,\nThanks,",
      "parentUuid": "ac013995_1991d557",
      "revId": "e9ee094d28f5cb6623c68467c0ffbf2ce33481b6",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6a659782_36834b8e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2023-05-30T20:54:52Z",
      "side": 1,
      "message": "ok - if it\u0027s a driver bug, can we apply the smaller limit only on ARM GPUs then? we can further reduce it based on driver version, if possible\n\nwe still should limit the storage buffer binding size if it is problematic on ARM GPUs.",
      "parentUuid": "13bc1682_3f30dbe1",
      "revId": "e9ee094d28f5cb6623c68467c0ffbf2ce33481b6",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "64847369_b52bd75a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1003636
      },
      "writtenOn": "2023-05-30T21:09:54Z",
      "side": 1,
      "message": "I started new patch which basically revert the changes, and limits it to ARM\u0026\u0026D3D12 case in the test.\n\nhttps://dawn-review.googlesource.com/c/dawn/+/135060\n\nthanks,all",
      "revId": "e9ee094d28f5cb6623c68467c0ffbf2ce33481b6",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    }
  ]
}