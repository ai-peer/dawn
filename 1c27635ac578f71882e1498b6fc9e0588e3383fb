{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "1aef28e6_725ecad3",
        "filename": "src/dawn/native/d3d12/DeviceD3D12.cpp",
        "patchSetId": 2
      },
      "lineNbr": 584,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2022-08-19T19:27:51Z",
      "side": 1,
      "message": "IMO I think it would be OK to reuse Dawn\u0027s internal fence and always make it shared. Dawn will already take care signaling it; we just have to save the signal value in SynchronizeTextureAfterUse to device-\u003eGetPendingCommandSerial()",
      "range": {
        "startLine": 578,
        "startChar": 4,
        "endLine": 584,
        "endChar": 5
      },
      "revId": "1c27635ac578f71882e1498b6fc9e0588e3383fb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "78af9390_ef2f1def",
        "filename": "src/dawn/native/d3d12/DeviceD3D12.cpp",
        "patchSetId": 2
      },
      "lineNbr": 584,
      "author": {
        "id": 1002701
      },
      "writtenOn": "2022-08-23T00:24:04Z",
      "side": 1,
      "message": "Also adding cwallez@ for thoughts on this. There\u0027s some risk of the client misusing Dawn\u0027s DeviceD3D12 internal fence, whereas using a separate fence per ExternalImageDXGIImpl is safer since it only affects interop with that image. Yes, you can still hang the Dawn command queue by providing invalid fences, but the question is if exposing the internal fence can cause more accidental damage.",
      "parentUuid": "1aef28e6_725ecad3",
      "range": {
        "startLine": 578,
        "startChar": 4,
        "endLine": 584,
        "endChar": 5
      },
      "revId": "1c27635ac578f71882e1498b6fc9e0588e3383fb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "887eff45_43d4aa98",
        "filename": "src/dawn/native/d3d12/DeviceD3D12.cpp",
        "patchSetId": 2
      },
      "lineNbr": 584,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2022-08-25T13:09:12Z",
      "side": 1,
      "message": "What is the risk of clients misusing Dawn\u0027s internal fence? That they might signal it when it should be only Dawn that does it? IMHO it could be part of the contract, and if people start messing with the fence then we could always wrap it in a COM interface that prevents Signal / add a second fence just for interop etc.\n\nIIRC Shaobo measured a significant perf difference in the classroom demo if the signaling was done only once per frame instead of for each shared image.",
      "parentUuid": "78af9390_ef2f1def",
      "range": {
        "startLine": 578,
        "startChar": 4,
        "endLine": 584,
        "endChar": 5
      },
      "revId": "1c27635ac578f71882e1498b6fc9e0588e3383fb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2130a6f3_0e04adab",
        "filename": "src/dawn/native/d3d12/ExternalImageDXGIImpl.cpp",
        "patchSetId": 2
      },
      "lineNbr": 72,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2022-08-19T19:27:51Z",
      "side": 1,
      "message": "don\u0027t think we would need this if we used Dawn\u0027s internal fence",
      "range": {
        "startLine": 69,
        "startChar": 7,
        "endLine": 72,
        "endChar": 9
      },
      "revId": "1c27635ac578f71882e1498b6fc9e0588e3383fb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ce35cb1d_ab84eeff",
        "filename": "src/dawn/native/d3d12/ExternalImageDXGIImpl.cpp",
        "patchSetId": 2
      },
      "lineNbr": 113,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2022-08-19T19:27:51Z",
      "side": 1,
      "message": "maybe add a TODO; IIUC, this is where we would use the imported fence cache?",
      "revId": "1c27635ac578f71882e1498b6fc9e0588e3383fb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "98c7fd90_9cf0f4ec",
        "filename": "src/dawn/native/d3d12/FenceD3D12.cpp",
        "patchSetId": 2
      },
      "lineNbr": 36,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2022-08-19T19:27:51Z",
      "side": 1,
      "message": "should return ResultOrError instead of using ErrorLog",
      "range": {
        "startLine": 36,
        "startChar": 0,
        "endLine": 36,
        "endChar": 10
      },
      "revId": "1c27635ac578f71882e1498b6fc9e0588e3383fb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "859a0129_cdee66e1",
        "filename": "src/dawn/native/d3d12/FenceD3D12.cpp",
        "patchSetId": 2
      },
      "lineNbr": 86,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2022-08-19T19:27:51Z",
      "side": 1,
      "message": "should return ResultOrError instead of using ErrorLog\n\nbut also, it wouldn\u0027t be needed if we use Dawn\u0027s internal fence",
      "range": {
        "startLine": 86,
        "startChar": 0,
        "endLine": 86,
        "endChar": 6
      },
      "revId": "1c27635ac578f71882e1498b6fc9e0588e3383fb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    }
  ]
}