{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "ce3662ef_1a37d655",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2024-05-09T14:56:07Z",
      "side": 1,
      "message": "might be missing some context - why did we decide to not use VK_EXT_multisampled_render_to_single_sampled on Vulkan?\n\nthe docs say the extension is much more efficient on some hardware",
      "revId": "a5a5159fa2b300468045ae0421151b2770213adb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5283bc7f_549a1051",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003501
      },
      "writtenOn": "2024-05-09T15:07:59Z",
      "side": 1,
      "message": "No we don\u0027t drop VK_EXT_multisampled_render_to_single_sampled. It\u0027s just that we don\u0027t need to implement MSAARenderToSingleSampled using 2 subpasses anymore. So I think we should drop the DawnMultisampleStateRenderToSingleSampled chained struct. That struct was originally intended for 2 subpasses implementation in vulkan where the render pipeline has to be compatible with the render pass with 2 subpasses.\n\nIn short:\n- DawnMultisampleStateRenderToSingleSampled will be implemented using VK_EXT_multisampled_render_to_single_sampled directly, there is no need for pipeline \u0026 render pass\u0027 compatibility anymore.\n- DawnLoadResolveTexture will be implemented in vulkan using 2 subpasses. And it needs pipeline compatibility info such as the new struct. Because VK_EXT_multisampled_render_to_single_sampled is not supported on all hardwares, so still need this feature implementation as an alternative.",
      "parentUuid": "ce3662ef_1a37d655",
      "revId": "a5a5159fa2b300468045ae0421151b2770213adb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "25fee186_e629366f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2024-05-09T15:55:09Z",
      "side": 1,
      "message": "wow.. https://vulkan.gpuinfo.org/listfeaturesextensions.php?extension\u003dVK_EXT_multisampled_render_to_single_sampled\u0026platform\u003dandroid says it is supported on 3.82% of devices. that\u0027s really unfortunate.",
      "parentUuid": "5283bc7f_549a1051",
      "revId": "a5a5159fa2b300468045ae0421151b2770213adb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2f191106_4a37d65f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003501
      },
      "writtenOn": "2024-05-09T16:05:07Z",
      "side": 1,
      "message": "btw, I guess your original question is why don\u0027t we use VK_EXT_multisampled_render_to_single_sampled to implement DawnLoadResolveTexture.\n- first is that it is not available everywhere.\n- Second its semantics is not the same as DawnLoadResolveTexture. VK_EXT_multisampled_render_to_single_sampled is \"giving dawn a single sampled texture, expect it to use multimsapling transparently\". Whereas DawnLoadResolveTexture is about \"giving Dawn both single sampled texture and MSAA texture and expect single sampled texture to be copied to MSAA texture\". We could use VK_EXT_multisampled_render_to_single_sampled and completely ignore the MSAA texture provided but it would work incorrectly if they want to store the MSAA texture.",
      "parentUuid": "5283bc7f_549a1051",
      "revId": "a5a5159fa2b300468045ae0421151b2770213adb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "22dfbc74_1a92ca46",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003501
      },
      "writtenOn": "2024-05-09T16:10:32Z",
      "side": 1,
      "message": "Well the second thing is not really an issue, I guess if VK_EXT_multisampled_render_to_single_sampled is used, we can just copy the resolve texture to MSAA texture at the end of the render pass if they want to store.",
      "parentUuid": "2f191106_4a37d65f",
      "revId": "a5a5159fa2b300468045ae0421151b2770213adb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a16e7539_f5db6d9c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003806
      },
      "writtenOn": "2024-05-09T16:19:22Z",
      "side": 1,
      "message": "\u003e https://vulkan.gpuinfo.org/listfeaturesextensions.php?extension\u003dVK_EXT_multisampled_render_to_single_sampled\u0026platform\u003dandroid\n\nFWIW, gpuinfo shows reports from the dawn of time (before the ext existed), so percentages are not really that valid. Added to that is the fact that it takes Android drivers 1-2 years before an extension can come out (at best), it really means you should expect 2023+ phones to have the extension. Phones releasing now are all pretty much expected to have the extension.\n\n---\n\n\u003e giving Dawn both single sampled texture and MSAA texture and expect single sampled texture to be copied to MSAA texture\n\nThat\u0027s an unfortunately inefficient design. Modelling that around MSRTSS would have been much better for tilers.\n\nAnd as for IMRs, I believe it would actually be better to _not_ do MSRTSS and let MSAA data be stored and loaded directly (instead of copied from the single-sampled texture), with the single sampled texture simply being the resolve attachment. That would save you one copy (from single- to multi-sampled texture), since the driver is going to do that separately before loading the MSAA data anyway.",
      "parentUuid": "22dfbc74_1a92ca46",
      "revId": "a5a5159fa2b300468045ae0421151b2770213adb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d010a2f8_11d8c065",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003501
      },
      "writtenOn": "2024-05-09T16:27:22Z",
      "side": 1,
      "message": "My \"very\" low end test android phone (samsung released last year) doesn\u0027t seem to have this extension.\n\n@syoussefi, we have two separate extensions: MSRTSS and DawnLoadResolveTexture. The latter is where client gives us both MSAA texture and resolve texture and expects the resolve texture to be loaded to MSAA texture. Note it is intended for those devices that don\u0027t support VK_EXT_multisampled_render_to_single_sampled including other backends (metal, d3d, etc) and skia wants to control the MSAA texture allocations.\n\nThe former MSAARTSS extension is still around, and it will utilise VK_EXT_multisampled_render_to_single_sampled.",
      "parentUuid": "a16e7539_f5db6d9c",
      "revId": "a5a5159fa2b300468045ae0421151b2770213adb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4dddf4f6_fb2a5eee",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003501
      },
      "writtenOn": "2024-05-09T16:45:03Z",
      "side": 1,
      "message": "btw, my lowend device is samsung A05s. Released last year. It has Adreno 610 GPU. Weird that it doesn\u0027t support VK_EXT_multisampled_render_to_single_sampled.",
      "parentUuid": "d010a2f8_11d8c065",
      "revId": "a5a5159fa2b300468045ae0421151b2770213adb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "36e504d9_45de7373",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003806
      },
      "writtenOn": "2024-05-09T17:18:02Z",
      "side": 1,
      "message": "\u003e Note it is intended for those devices that don\u0027t support VK_EXT_multisampled_render_to_single_sampled including other backends (metal, d3d, etc) and skia wants to control the MSAA texture allocations.\n\nWhat I was trying to get at is that for IMRs, you\u0027re better off _not_ doing an \"unresolve\". I guess if WebGPU already allows that path, it\u0027s up to Skia and others to choose to use `DawnLoadResolveTexture` or not",
      "parentUuid": "4dddf4f6_fb2a5eee",
      "revId": "a5a5159fa2b300468045ae0421151b2770213adb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8eaf2687_f4706815",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003501
      },
      "writtenOn": "2024-05-09T17:59:30Z",
      "side": 1,
      "message": "Chrome has been using DMSAA feature for awhile to save memory on various platforms. This feature is basically reusing MSAA textures and load from/store to resolve textures.",
      "parentUuid": "36e504d9_45de7373",
      "revId": "a5a5159fa2b300468045ae0421151b2770213adb",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    }
  ]
}