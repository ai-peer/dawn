{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "9bb12c8f_0d8901e4",
        "filename": "generator/dawn_common_generator.py",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2022-03-27T14:01:35Z",
      "side": 1,
      "message": "Thank you for changing this to a separate generator. Unfortunately I only now realized that there is an issue with this approach: adding the generation of the git hash at build time means that we need to give information to GN/CMake as to when the hash must be regenerated. This information takes the form of a list of files that when changed, re-run the action define by dawn_generator().\n\nHere we don\u0027t give any file as a list of dependencies (except from the script itself), so the commit hash would be regenerated correctly in various cases. There are multiple solution:\n\n- We could find the .git/HEAD and .git/\u003ccontent of HEAD\u003e (the latter contains the hash) and return them as dependencies. This requires trusting that the \"filesystem interface\" of git won\u0027t change, which is likely for such basic usage?\n- We could run something at gclient runhooks time, which is what ANGLE does IIRC. But we should double check if they needed something more.",
      "revId": "fdc161fe6cb163e225b20e77e58c05740fd7e75d",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3588d521_d6a4cadd",
        "filename": "generator/dawn_common_generator.py",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1002831
      },
      "writtenOn": "2022-03-28T23:52:32Z",
      "side": 1,
      "message": "Went with the first option and seems to be working. (I just built it at different commits where the generator Python script wasn\u0027t changed, and I still see the git hash being updated).\n\nI also renamed it again because now every file generated by this generator is re-generated whenever the git hash changes, so it isn\u0027t as \"common\" to use it anymore.",
      "parentUuid": "9bb12c8f_0d8901e4",
      "revId": "fdc161fe6cb163e225b20e77e58c05740fd7e75d",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    }
  ]
}