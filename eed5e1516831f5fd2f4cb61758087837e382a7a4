{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "19764863_07ec1aa1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1003581
      },
      "writtenOn": "2024-04-18T19:35:19Z",
      "side": 1,
      "message": "Please take a look.",
      "revId": "eed5e1516831f5fd2f4cb61758087837e382a7a4",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3f610757_e1fab147",
        "filename": "src/dawn/native/Device.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1089,
      "author": {
        "id": 1003581
      },
      "writtenOn": "2024-04-18T19:35:19Z",
      "side": 1,
      "message": "I\u0027m assuming this is what we wanted? This would still report metric on every pipeline insertion, so maybe we want to do this after all pipelines are created. Although, I\u0027m not sure if its even possible to know when all pipelines will be created so do let me know. \n\nI also guessed there wouldn\u0027t be more than 10k pipelines and just used this macro.",
      "revId": "eed5e1516831f5fd2f4cb61758087837e382a7a4",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "255e5a35_57e98617",
        "filename": "src/dawn/native/Device.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1089,
      "author": {
        "id": 1002701
      },
      "writtenOn": "2024-04-18T20:49:05Z",
      "side": 1,
      "message": "Like enga@ mentioned on the bug, I think we just want a counter for the number of CreateRenderPipeline calls that result in a cache miss. IIUC AddOrGetCachedRenderPipeline is only called for pipelines that were compiled from scratch (i.e. cache miss) for both the sync and async paths. The other kind is pipelines which don\u0027t define a layout and therefore do not use the cache - you\u0027ll have to increment the total count for those in CreateRenderPipeline(Async).",
      "parentUuid": "3f610757_e1fab147",
      "revId": "eed5e1516831f5fd2f4cb61758087837e382a7a4",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a7bb9a5f_87070298",
        "filename": "src/dawn/native/Device.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1089,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2024-04-18T20:50:58Z",
      "side": 1,
      "message": "question about histograms in Chrome (the macro just delegates to Chrome)\n\nisn\u0027t this going to log a histogram for: 1, 2, 3, 4, 5, ......., Count ? since it\u0027ll log every time a pipeline is added? That doesn\u0027t seem like what we want.\n\nOr, does Chrome overwrite results with the most recent one?",
      "parentUuid": "255e5a35_57e98617",
      "revId": "eed5e1516831f5fd2f4cb61758087837e382a7a4",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "808aaaf6_0105dbf3",
        "filename": "src/dawn/native/Device.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1089,
      "author": {
        "id": 1002701
      },
      "writtenOn": "2024-04-18T20:56:16Z",
      "side": 1,
      "message": "I think each of the calls will get emitted to UMA, so maybe we want to emit this at Device destruction time?",
      "parentUuid": "a7bb9a5f_87070298",
      "revId": "eed5e1516831f5fd2f4cb61758087837e382a7a4",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1e6300f6_bf494aa0",
        "filename": "src/dawn/native/Device.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1089,
      "author": {
        "id": 1003581
      },
      "writtenOn": "2024-04-19T16:01:00Z",
      "side": 1,
      "message": "Thanks for clarifying! I updated to have a counter and increment it in both sync and async creation places. Also updated to have the UMA emitted at destruction time only if there was even a single pipeline created (some histogram tests were failing here maybe because of Device destruction they had expectation mismatches.)\n\nI think we should still count if pipeline creation fails especially if there was a lot of work done before failing? If not, I could update for sync to check based on IsSuccess but not sure about async.",
      "parentUuid": "808aaaf6_0105dbf3",
      "revId": "eed5e1516831f5fd2f4cb61758087837e382a7a4",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "068cf5d1_58387a0d",
        "filename": "src/dawn/native/Device.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1089,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2024-04-19T16:28:03Z",
      "side": 1,
      "message": "no strong opinions about errors. I\u0027d imagine Graphite should reach a state where there are zero, or minimal rare errors.\n\nDid we check that destruction is OK? Not sure when Graphite destroys its device - if it\u0027s when the browser is shutting down, does Chrome actually emit the UMA?\n\nLGTM otherwise",
      "parentUuid": "1e6300f6_bf494aa0",
      "revId": "eed5e1516831f5fd2f4cb61758087837e382a7a4",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    }
  ]
}