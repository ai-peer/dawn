{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "23c2ed9b_f0214b76",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1002886
      },
      "writtenOn": "2022-06-21T14:13:02Z",
      "side": 1,
      "message": "Brian, do you know anything about the testing/test.gni?",
      "revId": "889a499ef471aa16918f701da4988d1c3b38146d",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aadddce6_f8475686",
        "filename": "src/tint/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 16,
      "author": {
        "id": 1002886
      },
      "writtenOn": "2022-06-21T14:03:45Z",
      "side": 1,
      "message": "This import is causing an issue with the Skia build of Dawn. We don\u0027t have a //testing/test.gni",
      "revId": "889a499ef471aa16918f701da4988d1c3b38146d",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0c4973c2_d069975d",
        "filename": "src/tint/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 16,
      "author": {
        "id": 1003216
      },
      "writtenOn": "2022-06-21T14:11:24Z",
      "side": 1,
      "message": "Does skia have the equivalent file somewhere else or just does without it? What does it use when integrating into Chromium? As far as I know we got the file from Chromium and it\u0027s what provides the `test` template.",
      "parentUuid": "aadddce6_f8475686",
      "revId": "889a499ef471aa16918f701da4988d1c3b38146d",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bc782d53_99eaa5e9",
        "filename": "src/tint/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 16,
      "author": {
        "id": 1000076
      },
      "writtenOn": "2022-06-21T14:52:33Z",
      "side": 1,
      "message": "No, Skia (unlike many of the other chromium-adjacent projects), doesn\u0027t pull in //build (or //testing, which is a new one to me). Our GN build is more-or-less self-contained. Chromium doesn\u0027t directly use our top-level GN files/rules. There is a separate GN files that control how Skia is built into chromium checked into that repo (https://source.chromium.org/chromium/chromium/src/+/main:skia/BUILD.gn). That file just relies on Skia\u0027s GN files to declare lists of source files for various components.\n\nWe\u0027ve hit some similar issues to this with ANGLE, because we had a push to use ANGLE\u0027s GN files when compiling it in (standalone) Skia. Those GN files have a similar dependence on chromium\u0027s //build, so they added a GN variable (set via build_overrides), called `angle_has_build`. That\u0027s used to guard all imports of things in //build, and to choose reasonable stand-alone defaults when set to false.",
      "parentUuid": "0c4973c2_d069975d",
      "revId": "889a499ef471aa16918f701da4988d1c3b38146d",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e895cf84_6a7b0697",
        "filename": "src/tint/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 16,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2022-06-21T14:56:42Z",
      "side": 1,
      "message": "Oh I should have caught this during the review. What we had to do in the past for this is split the GN files in multiple directories so that the GN build of Skia doesn\u0027t find the tests. So in this case the Tint test GN rules would be in src/tint/tests. src/tint/BUILD.gn wouldn\u0027t have any link to src/tint/tests/BUILD.gn, such that Skia doesn\u0027t discover it. That\u0027s what happens with Dawn at the moment.",
      "parentUuid": "bc782d53_99eaa5e9",
      "revId": "889a499ef471aa16918f701da4988d1c3b38146d",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "85e40673_ed2a46e5",
        "filename": "src/tint/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 16,
      "author": {
        "id": 1000257
      },
      "writtenOn": "2022-06-21T15:34:29Z",
      "side": 1,
      "message": "Hm, that doesn\u0027t work as well for tint as we don\u0027t have a src/tint/tests folder like Dawn does. Tint puts the test files in the same location as the files under test. If we go that route we\u0027ll end up with a src/tint/test folder which only has a BUILD.gn file which references files in the parent folder, which is odd.\n\nCould we add a tint_disable_test gn flag that wraps the import and the adding of the tint unittests? Defaults to true and Skia can override to false?",
      "parentUuid": "e895cf84_6a7b0697",
      "revId": "889a499ef471aa16918f701da4988d1c3b38146d",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ede58394_a4eb14f4",
        "filename": "src/tint/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 16,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2022-06-21T15:36:12Z",
      "side": 1,
      "message": "Yeah for Tint\u0027s structure it\u0027s a bit odd. The extra flag would work and if it becomes annoying we can always figure out later.",
      "parentUuid": "85e40673_ed2a46e5",
      "revId": "889a499ef471aa16918f701da4988d1c3b38146d",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    }
  ]
}