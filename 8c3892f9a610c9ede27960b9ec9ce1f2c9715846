{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "9581dc96_4c6c2898",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 13,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2021-02-23T20:37:47Z",
      "side": 1,
      "message": "to clarify: which validation? Is it the ValidateSpirv that happens after ModuleToSpirv ? IIRC, this check was mostly a temporary sanity check since sometimes Tint lets through bad SPIR-V.\n\nDo we still need to reorder this if we update ModuleToSpirv to use tint::transform::Spirv instaed ?",
      "range": {
        "startLine": 13,
        "startChar": 0,
        "endLine": 13,
        "endChar": 271
      },
      "revId": "8c3892f9a610c9ede27960b9ec9ce1f2c9715846",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "27d0c3bb_42ce1249",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 13,
      "author": {
        "id": 1001737
      },
      "writtenOn": "2021-02-23T20:56:10Z",
      "side": 1,
      "message": "\u003e  Is it the ValidateSpirv that happens after ModuleToSpirv ? IIRC, this check was mostly a temporary sanity check since sometimes Tint lets through bad SPIR-V.\n\nYes, that\u0027s the one.\n\n\u003e Do we still need to reorder this if we update ModuleToSpirv to use tint::transform::Spirv instaed ?\n\nI think I have to draw out a graph to answer this. I really struggle to keep a mental map of where all the tint logic goes.\n\nThe rules are:\n(a) Each backend (generator) will need to have a tint::transform::[Spirv,Hlsl,Msl] sanitizer applied to the program.\n(b) Reflection needs to be done on the same program that the generator consumes. Reflecting a program before it is transformed is likely to provide information that is not in sync with the shader program used by the graphics API.\n(c) Any number of common transforms can be applied between parsing and the sanitizer transforms. These don\u0027t need to be part of the same transform::Manager run.",
      "parentUuid": "9581dc96_4c6c2898",
      "range": {
        "startLine": 13,
        "startChar": 0,
        "endLine": 13,
        "endChar": 271
      },
      "revId": "8c3892f9a610c9ede27960b9ec9ce1f2c9715846",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3091dc92_774e7dd4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 13,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2021-02-23T21:10:08Z",
      "side": 1,
      "message": "Yes there are very many paths and it\u0027s hard to understand. Just to be clear, the way I *think* this works is:\n\n\nWGSL / SPIR-V \n     |\n tint::Program\n     |\n backend-specific transforms (ex. EmitVertexPointSize)\n     |\n frontend transforms (ex. bound array accessors)\n     |                            \\\n backend code generation           reflection\n    /   \\                          /          \\\ntint   tint-\u003espirv-\u003ecross    tint-\u003espirv      tint reflection\n                             |\n                         spirv cross reflection\n\n\nIn this picture, you\u0027ve changed tint-\u003espirv on the backend code generation side, to use tint::transform::Spirv before tint::writer::spirv::Generator, but the reflection side is still only has tint::writer::spirv::Generator without the transform.\n\nI think tecncially, what I\u0027ve sketched here breaks (b) in that reflection is done on a different program, BUT they originated from the same program (post frontend transforms), and we performed the same spirv transforms on them for reflection afterword.",
      "parentUuid": "27d0c3bb_42ce1249",
      "range": {
        "startLine": 13,
        "startChar": 0,
        "endLine": 13,
        "endChar": 271
      },
      "revId": "8c3892f9a610c9ede27960b9ec9ce1f2c9715846",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4d60a192_fa78d16b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 14,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2021-02-23T20:37:47Z",
      "side": 1,
      "message": "though that\u0027s just because Tint doesn\u0027t support all the reflection information yet. I would think we would still be able to correctly convert to Spirv inside InitializeBase in order to do the (temporary) reflection.",
      "range": {
        "startLine": 14,
        "startChar": 0,
        "endLine": 14,
        "endChar": 143
      },
      "revId": "8c3892f9a610c9ede27960b9ec9ce1f2c9715846",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "99bb9d1b_a887725b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 14,
      "author": {
        "id": 1001737
      },
      "writtenOn": "2021-02-23T20:56:10Z",
      "side": 1,
      "message": "Yup, understood.",
      "parentUuid": "4d60a192_fa78d16b",
      "range": {
        "startLine": 14,
        "startChar": 0,
        "endLine": 14,
        "endChar": 143
      },
      "revId": "8c3892f9a610c9ede27960b9ec9ce1f2c9715846",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "52ad84c3_1d31230e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1000032
      },
      "writtenOn": "2021-02-23T20:37:47Z",
      "side": 1,
      "message": "Overall, looks good with some questions",
      "revId": "8c3892f9a610c9ede27960b9ec9ce1f2c9715846",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    }
  ]
}