{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "f5daeae4_39658059",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2021-03-05T07:06:55Z",
      "side": 1,
      "message": "LGTM, thanks for the fix! Ben can you also check if the use of TINT_ENABLE_SHARED_CRT is correct?",
      "revId": "fcc167c84cc1033294c94030855a835bd629e1e9",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2248cb7a_ba325f3a",
        "filename": "third_party/CMakeLists.txt",
        "patchSetId": 3
      },
      "lineNbr": 87,
      "author": {
        "id": 1001737
      },
      "writtenOn": "2021-03-08T11:49:41Z",
      "side": 1,
      "message": "This is un-defaulting logic in Tint\u0027s CMakeLists.txt that explicitly defaults to using static CRT.\n\nhttps://source.chromium.org/chromium/chromium/src/+/master:third_party/tint/src/CMakeLists.txt;l\u003d47-53\n\nThe reason given is:\n\n  # We don\u0027t want to have to copy the C Runtime DLL everywhere the executable\n  # goes.  So by default compile code to assume the CRT is statically linked,\n  # i.e. use /MT* options.  For debug builds use /MTd, and for release builds\n  # use /MT.  If TINT_ENABLE_SHARED_CRT is ON, then use the shared C runtime.\n  # Modify the project-wide options variables. This is ugly, but seems to be\n  # the state of the art.\n\nThis landed in https://dawn-review.googlesource.com/c/tint/+/20940, which has the rather nondescript CL description:\n\n  Windows fixes.\n\n  This CL fixes up some issues which give compile errors when building\n  with Visual Studio.\n\nMaybe the TINT_ENABLE_SHARED_CRT was just a preference. Maybe there was some build issue.\n\nI don\u0027t really mind what the defaults here are, but it is a bit odd that we\u0027re attempting to disable by-default logic in tint in its outer project. Perhaps we should just be removing this logic from our Tint CMake rules.\n\nApproving as I don\u0027t really mind either way, and Corentin can make the final call.",
      "range": {
        "startLine": 85,
        "startChar": 0,
        "endLine": 87,
        "endChar": 32
      },
      "revId": "fcc167c84cc1033294c94030855a835bd629e1e9",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "32f613a5_b95dcc07",
        "filename": "third_party/CMakeLists.txt",
        "patchSetId": 3
      },
      "lineNbr": 87,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2021-03-08T12:00:37Z",
      "side": 1,
      "message": "What do you think of removing that logic from Tint\u0027s CMakeList? CMake \u003e\u003d 3.15 supports CMAKE_MSVC_RUNTIME_LIBRARY to configure this on a project level, and in CMake \u003c 3.14 users can edit the CMAKE_CXX_FLAGS_DEBUG directly.\n\nSee https://cmake.org/cmake/help/v3.20/policy/CMP0091.html#policy:CMP0091 for more info.\n\nRemoving the logic in Tint would make it honor the global CMAKE_MSVC_RUNTIME_LIBRARY so that developers have a single variable to change to choose which CRT to use (instead of both CMAKE_MSVC_RUNTIME_LIBRARY and TINT_ENABLE_SHARED_CRT).",
      "parentUuid": "2248cb7a_ba325f3a",
      "range": {
        "startLine": 85,
        "startChar": 0,
        "endLine": 87,
        "endChar": 32
      },
      "revId": "fcc167c84cc1033294c94030855a835bd629e1e9",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c39c8930_15636f44",
        "filename": "third_party/CMakeLists.txt",
        "patchSetId": 3
      },
      "lineNbr": 87,
      "author": {
        "id": 1001737
      },
      "writtenOn": "2021-03-08T12:34:10Z",
      "side": 1,
      "message": "Sure. Based on my understanding of why this was originally done, I don\u0027t have any issues removing it. My only concern is that I don\u0027t primarily develop on Windows, and I might inadvertently break some usage I\u0027m unaware of. \n\nAleksi - given that you wanted to change this default, would you be willing to give https://dawn-review.googlesource.com/c/tint/+/44045 a quick try? With this change, you should be able to revert your changes to this file, along with:\n\n        set(TINT_BUILD_TESTS OFF CACHE BOOL \"\" FORCE)\n        set(TINT_BUILD_DOCS OFF CACHE BOOL \"\" FORCE)\n\n\nThanks!",
      "parentUuid": "32f613a5_b95dcc07",
      "range": {
        "startLine": 85,
        "startChar": 0,
        "endLine": 87,
        "endChar": 32
      },
      "revId": "fcc167c84cc1033294c94030855a835bd629e1e9",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "35c74289_a5272b07",
        "filename": "third_party/CMakeLists.txt",
        "patchSetId": 3
      },
      "lineNbr": 87,
      "author": {
        "id": 1001616
      },
      "writtenOn": "2021-03-08T15:04:49Z",
      "side": 1,
      "message": "I was able to build the dawn main branch with your changes to tint (and my fix to the other cmake file) without a problem.\n\nI should\u0027ve explained more the problem I encountered. Since dawn is statically linked by default, all the libraries must use the same type of CRT, otherwise a linking error occurs. By default CMake uses the shared CRT, so tint couldn\u0027t link when trying to build with default options, because it was built with a static CRT.\n\n\"dawn\\out\\build\\x64-Debug\\SPIRV-Tools.lib(libspirv.cpp.obj) : error LNK2038: mismatch detected for \u0027RuntimeLibrary\u0027: value \u0027MDd_DynamicDebug\u0027 doesn\u0027t match value \u0027MTd_StaticDebug\u0027 in main.cc.obj\" \u003c- main.cc is a tint file.\n\nI initially encountered this error in my project that depends on dawn, but worked around it by adding \"set(CMAKE_MSVC_RUNTIME_LIBRARY \"MultiThreaded$\u003c$\u003cCONFIG:Debug\u003e:Debug\u003e\")\" to my cmake files, so all libraries used the static CRT, and didn\u0027t investigate further. Only when I tried to build dawn standalone to fix the missing source files in cmake did I decide I should try to fix the problem at the source. Since shaderc also defaulted to the static CRT link tint, I just applied the same fix.\n\nThere was also a separate issue with tint trying to generate docs in \"third_party/tint/out/docs\". Since \"out\" doesn\u0027t exist, Doxygen will give an error, because it will only create the last directory of the path if it doesn\u0027t exist (here that would be \"docs\"), but not parents. Simplest solution is just to disable the docs in dawn.",
      "parentUuid": "c39c8930_15636f44",
      "range": {
        "startLine": 85,
        "startChar": 0,
        "endLine": 87,
        "endChar": 32
      },
      "revId": "fcc167c84cc1033294c94030855a835bd629e1e9",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "930a1f5f_5bd61edb",
        "filename": "third_party/CMakeLists.txt",
        "patchSetId": 3
      },
      "lineNbr": 87,
      "author": {
        "id": 1001737
      },
      "writtenOn": "2021-03-09T13:58:44Z",
      "side": 1,
      "message": "Thank you for the additional context.\nhttps://dawn-review.googlesource.com/c/tint/+/44045 has landed. This should be rolled into Dawn shortly.",
      "parentUuid": "35c74289_a5272b07",
      "range": {
        "startLine": 85,
        "startChar": 0,
        "endLine": 87,
        "endChar": 32
      },
      "revId": "fcc167c84cc1033294c94030855a835bd629e1e9",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "40db2a0f_8de5943d",
        "filename": "third_party/CMakeLists.txt",
        "patchSetId": 3
      },
      "lineNbr": 87,
      "author": {
        "id": 1001616
      },
      "writtenOn": "2021-03-11T15:31:47Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "930a1f5f_5bd61edb",
      "range": {
        "startLine": 85,
        "startChar": 0,
        "endLine": 87,
        "endChar": 32
      },
      "revId": "fcc167c84cc1033294c94030855a835bd629e1e9",
      "serverId": "dd02978d-1a8e-36d7-bcc0-a5723e5c0abd"
    }
  ]
}